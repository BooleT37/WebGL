<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="style.css">
	<script id="vertex_shader" type="x-shader/x-vertex">
		attribute vec2 a_position;
		uniform mat3 u_matrix;
		varying vec2 v_texCoord;
		void main() {
			gl_Position = vec4(u_matrix * vec3(a_position, 1), 1);
			
			// because we're using a unit quad we can just use
			// the same data for our texcoords.
			v_texCoord = a_position;
		}
	</script>
	<script id="fragment_shader" type="x-shader/x-fragment">
		precision mediump float;
		uniform bool u_turnGrayscale;
		uniform sampler2D u_image;
		uniform vec4 u_colorComponents;
		uniform float u_gamma;
		varying vec2 v_texCoord;
		
		void main() {
			vec4 color = texture2D(u_image, v_texCoord);
			if (u_turnGrayscale) {
				float avg = (color.r + color.g + color.b) / 3.0;
				color.rgb = vec3(avg, avg, avg);
			}
			color.rgba = vec4(color.r * u_colorComponents[0], color.g * u_colorComponents[1], color.b * u_colorComponents[2], color.a * u_colorComponents[3]);
			color.rgba = vec4(pow(color.r, u_gamma), pow(color.g, u_gamma), pow(color.b, u_gamma), color.a);
			gl_FragColor = color;
		}
	</script>
	<script src="WebglImageProcessor.js"></script>
	<script src="scripts.js"></script>
	<link rel="icon" type="image/ico" href="favicon.ico">
	<title>WebGL experimentation</title>
</head>
<body onload="onLoad()">
	<div id="wrapper">
		<div id="image_area">
			<div id="title">Загрузите файл с компьютера:</div>
			<input type="file" id="file_input"><br/>
			<canvas id="canvas" width="640" height="480" style="border:1px solid #c3c3c3;">Doesn't work :(</canvas>
		</div>
		<div id="buttons_area">
			<button id="turn_grayscale_button" disabled="disabled">Сделать черно-белым</button>
			<div id="rotate_text">Повернуть на</div><input id="degrees_input" value="0" min="0" max="359" type="number" disabled="disabled"></input>&#176;
			<input id="rotate_slider" type="range" min="0" max="359" step="1" value="0" disabled="disabled">
			<div class = "color_component_selector">
				<div class="color_component_text">R:</div>
				<input class="color_component_slider" id="r_component_slider" type="range" min="0" max="100" step="1" value="100" disabled="disabled">
				<input class="color_component_input" id="r_component_input" value="100" min="0" max="100" type="number" disabled="disabled"></input><span class="percent_sign">%</class>
			</div>
			<div class = "color_component_selector">
				<div class="color_component_text">G:</div>
				<input class="color_component_slider" id="g_component_slider" type="range" min="0" max="100" step="1" value="100" disabled="disabled">
				<input class="color_component_input" id="g_component_input" value="100" min="0" max="100" type="number" disabled="disabled"></input><span class="percent_sign">%</class>
			</div>
			<div class = "color_component_selector">
				<div class="color_component_text">B:</div>
				<input class="color_component_slider" id="b_component_slider" type="range" min="0" max="100" step="1" value="100" disabled="disabled">
				<input class="color_component_input" id="b_component_input" value="100" min="0" max="100" type="number" disabled="disabled"></input><span class="percent_sign">%</class>
			</div>
			<div class = "color_component_selector">
				<div class="color_component_text">A:</div>
				<input class="color_component_slider" id="a_component_slider" type="range" min="0" max="100" step="1" value="100" disabled="disabled">
				<input class="color_component_input" id="a_component_input" value="100" min="0" max="100" type="number" disabled="disabled"></input><span class="percent_sign">%</class>
			</div>
			<div>
				<div id="gamma_text">Гамма:</div>
				<input id="gamma_slider" type="range" min="0" max="4" step=0.1 value="1" disabled="disabled">
				<input id="gamma_input" value="1" min="0" max="4" type="number" step=0.1 disabled="disabled"></input>
			</div>
			<button id="restore_button" disabled="disabled">Восстановить</button>
			<button id="save_button" disabled="disabled">Сохранить изображение</button>
		</div>
	</div>
</body>
</html>